
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit 6 å•è¯å­¦ä¹ åº”ç”¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen font-sans">
    <div class="container mx-auto px-4 py-8 max-w-xl">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-indigo-700">Unit 6 å•è¯å­¦ä¹ åº”ç”¨</h1>
            <p class="text-gray-600 mt-2">å¡«å†™å•è¯ç©ºæ ¼ï¼Œæé«˜æ‚¨çš„è¯æ±‡é‡</p>
        </header>

        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm text-gray-500" id="progress">1/50</span>
                    <span class="text-sm text-gray-500" id="score">å¾—åˆ†: 0</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="bg-indigo-600 h-2 rounded-full" id="progress-bar" style="width: 2%"></div>
                </div>
            </div>

            <div class="mb-8">
                <div class="mb-6">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold text-gray-800 mb-2">å®šä¹‰:</h2>
                        <button id="speak-definition" class="text-indigo-600 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
                            </svg>
                            æœ—è¯»å®šä¹‰
                        </button>
                    </div>
                    <p class="text-lg text-gray-700" id="definition"></p>
                </div>
                
                <div class="mb-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">æç¤º:</h2>
                    <p class="text-lg font-mono" id="hint"></p>
                </div>

                <div class="mb-4">
                    <label for="answer" class="block text-gray-700 font-medium mb-2">å¡«å†™å•è¯:</label>
                    <input type="text" id="answer" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>

                <div id="feedback" class="mb-4 py-2 px-4 rounded-lg hidden"></div>
                
                <div class="flex space-x-3">
                    <button id="prev-btn" class="flex-1 bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600 transition" disabled>
                        ä¸Šä¸€ä¸ª
                    </button>
                    <button id="check-btn" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition">
                        æ£€æŸ¥ç­”æ¡ˆ
                    </button>
                    <button id="next-btn" class="flex-1 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition" disabled>
                        ä¸‹ä¸€ä¸ª
                    </button>
                </div>
            </div>
        </div>
        
        <div class="mt-6 p-4 bg-white rounded-xl shadow-lg">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">å­¦ä¹ ç»Ÿè®¡</h2>
            <div class="grid grid-cols-2 gap-4 text-center">
                <div class="bg-green-100 p-3 rounded-lg">
                    <p class="text-sm text-gray-600">æ­£ç¡®</p>
                    <p class="text-2xl font-bold text-green-600" id="correct-count">0</p>
                </div>
                <div class="bg-red-100 p-3 rounded-lg">
                    <p class="text-sm text-gray-600">é”™è¯¯</p>
                    <p class="text-2xl font-bold text-red-600" id="wrong-count">0</p>
                </div>
            </div>
        </div>

        <div class="mt-6 p-4 bg-white rounded-xl shadow-lg">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">è¯­éŸ³è®¾ç½®</h2>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label for="voice-language" class="block text-sm font-medium text-gray-700 mb-1">è¯­è¨€</label>
                    <select id="voice-language" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                        <option value="en-US">è‹±è¯­ (ç¾å›½)</option>
                        <option value="en-GB">è‹±è¯­ (è‹±å›½)</option>
                        <option value="zh-CN">ä¸­æ–‡ (æ™®é€šè¯)</option>
                    </select>
                </div>
                <div>
                    <label for="voice-rate" class="block text-sm font-medium text-gray-700 mb-1">è¯­é€Ÿ</label>
                    <input type="range" id="voice-rate" min="0.5" max="2" step="0.1" value="1" class="w-full">
                </div>
            </div>
        </div>
    </div>

    <script>
        // å•è¯åˆ—è¡¨ - ä»å›¾ç‰‡ä¸­æå–çš„Unit 6å•è¯
        const vocabulary = [
            { 
                word: "rain or shine", 
                definition: "ä¸è®ºæ˜¯é›¨æˆ–æ˜¯æ™´ï¼›ä¸ç®¡å‘ç”Ÿä»€ä¹ˆäº‹", 
                hint: "r_ _ _  o_  s_ _ _ _",
                phonetic: "/reÉªn É”r ÊƒaÉªn/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "affect", 
                definition: "å½±å“", 
                hint: "a _ _ _ _ t",
                phonetic: "/É™Ëˆfekt/",
                partOfSpeech: "v."
            },
            { 
                word: "dry", 
                definition: "å¹²çš„ï¼›å¹²æ—±çš„", 
                hint: "d _ _",
                phonetic: "/draÉª/",
                partOfSpeech: "adj."
            },
            { 
                word: "lightning", 
                definition: "é—ªç”µ", 
                hint: "l _ _ _ _ _ _ _ g",
                phonetic: "/ËˆlaÉªtnÉªÅ‹/",
                partOfSpeech: "n."
            },
            { 
                word: "stormy", 
                definition: "æœ‰æš´é£é›¨(æˆ–æš´é£é›ª)çš„", 
                hint: "s _ _ _ _ y",
                phonetic: "/ËˆstÉ”Ërmi/",
                partOfSpeech: "adj."
            },
            { 
                word: "north", 
                definition: "åŒ—éƒ¨åŒ—åŒ—æ–¹", 
                hint: "n _ _ _ h",
                phonetic: "/nÉ”ËÎ¸/",
                partOfSpeech: "n."
            },
            { 
                word: "west", 
                definition: "è¥¿éƒ¨è¥¿è¥¿æ–¹", 
                hint: "w _ _ t",
                phonetic: "/west/",
                partOfSpeech: "n."
            },
            { 
                word: "south", 
                definition: "å—éƒ¨å—å—æ–¹", 
                hint: "s _ _ _ h",
                phonetic: "/saÊŠÎ¸/",
                partOfSpeech: "n."
            },
            { 
                word: "east", 
                definition: "ä¸œéƒ¨ä¸œä¸œæ–¹", 
                hint: "e _ _ t",
                phonetic: "/iËst/",
                partOfSpeech: "n."
            },
            { 
                word: "centre", 
                definition: "ä¸­é—´ä¸­å¿ƒç‚¹", 
                hint: "c _ _ _ _ e",
                phonetic: "/ËˆsentÉ™(r)/",
                partOfSpeech: "n."
            },
            { 
                word: "stay in", 
                definition: "å¾…åœ¨å®¶é‡Œæ²¡æœ‰å¤–å‡º", 
                hint: "s _ _ _  i_",
                phonetic: "/steÉª Éªn/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "lucky", 
                definition: "è¿æ°”å¥½çš„å¸¦æ¥å¥½è¿çš„", 
                hint: "l _ _ _ y",
                phonetic: "/ËˆlÊŒki/",
                partOfSpeech: "adj."
            },
            { 
                word: "sunbathe", 
                definition: "æ²æ—¥å…‰æµ´æ™’å¤ªé˜³", 
                hint: "s _ _ _ _ _ _ e",
                phonetic: "/ËˆsÊŒn,beÉªÃ°/",
                partOfSpeech: "v."
            },
            { 
                word: "some day", 
                definition: "å°†æ¥æœ‰æœä¸€æ—¥", 
                hint: "s _ _ e  d_ _",
                phonetic: "/sÊŒm deÉª/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "temperature", 
                definition: "æ¸©åº¦", 
                hint: "t _ _ _ _ _ _ _ _ _ e",
                phonetic: "/ËˆtemprÉ™tÊƒÉ™(r)/",
                partOfSpeech: "n."
            },
            { 
                word: "snowman", 
                definition: "é›ªäºº", 
                hint: "s _ _ _ _ _ n",
                phonetic: "/ËˆsnÉ™ÊŠmÉ™n/",
                partOfSpeech: "n."
            },
            { 
                word: "heavily", 
                definition: "å¤§é‡åœ°æ²‰é‡åœ°", 
                hint: "h _ _ _ _ _ y",
                phonetic: "/Ëˆhevili/",
                partOfSpeech: "adv."
            },
            { 
                word: "snowy", 
                definition: "ä¸‹é›ªçš„é›ªç™½çš„", 
                hint: "s _ _ _ y",
                phonetic: "/ËˆsnÉ™ÊŠi/",
                partOfSpeech: "adj."
            },
            { 
                word: "beach volleyball", 
                definition: "æ²™æ»©æ’çƒ", 
                hint: "b _ _ _ h  v_ _ _ _ _ _ _ _ l",
                phonetic: "/biËtÊƒ ËˆvÉ’libÉ”Ël/",
                partOfSpeech: "n."
            },
            { 
                word: "high", 
                definition: "é«˜", 
                hint: "h _ _ h",
                phonetic: "/haÉª/",
                partOfSpeech: "v. & adj."
            },
            { 
                word: "freezing", 
                definition: "æå†·çš„å†°å†»çš„", 
                hint: "f _ _ _ _ _ _ g",
                phonetic: "/ËˆfriËzÉªÅ‹/",
                partOfSpeech: "adj."
            },
            { 
                word: "tourist", 
                definition: "æ—…è¡Œè€…è§‚å…‰å®¢", 
                hint: "t _ _ _ _ _ t",
                phonetic: "/ËˆtÊŠÉ™rÉªst/",
                partOfSpeech: "n."
            },
            { 
                word: "mount", 
                definition: "(åœ¨ç°ä»£è‹±è¯­é‡Œä»…ç”¨äºåœ°å)å±±å³°", 
                hint: "m _ _ _ t",
                phonetic: "/maÊŠnt/",
                partOfSpeech: "n."
            },
            { 
                word: "cloud", 
                definition: "äº‘å½©", 
                hint: "c _ _ _ d",
                phonetic: "/klaÊŠd/",
                partOfSpeech: "n."
            },
            { 
                word: "feel like", 
                definition: "æ„Ÿè§‰åƒ", 
                hint: "f _ _ l  l_ _ _",
                phonetic: "/fiËl laÉªk/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "magical", 
                definition: "é­”æ³•çš„ç¥å¥‡çš„", 
                hint: "m _ _ _ _ _ l",
                phonetic: "/ËˆmÃ¦dÊ’Éªkl/",
                partOfSpeech: "adj."
            },
            { 
                word: "rock", 
                definition: "å²©çŸ³", 
                hint: "r _ _ k",
                phonetic: "/rÉ’k/",
                partOfSpeech: "n."
            },
            { 
                word: "rest", 
                definition: "ä¼‘æ¯ï¼›å‰©ä½™éƒ¨åˆ†", 
                hint: "r _ _ t",
                phonetic: "/rest/",
                partOfSpeech: "n."
            },
            { 
                word: "area", 
                definition: "åœºåœ°ï¼›åœ°åŒº", 
                hint: "a _ _ a",
                phonetic: "/ËˆeÉ™riÉ™/",
                partOfSpeech: "n."
            },
            { 
                word: "rest area", 
                definition: "ä¼‘æ¯åŒº", 
                hint: "r _ _ t  a_ _ _",
                phonetic: "/rest ËˆeÉ™riÉ™/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "make progress", 
                definition: "å–å¾—è¿›å±•", 
                hint: "m _ _ e  p_ _ _ _ _ _ s",
                phonetic: "/meÉªk ËˆprÉ™ÊŠÉ¡res/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "although", 
                definition: "è™½ç„¶ï¼›å°½ç®¡", 
                hint: "a _ _ _ _ _ _ h",
                phonetic: "/É”ËlËˆÃ°É™ÊŠ/",
                partOfSpeech: "conj."
            },
            { 
                word: "in high spirits", 
                definition: "æƒ…ç»ªé«˜æ¶¨ï¼›å…´é«˜é‡‡çƒˆ", 
                hint: "i_  h_ _ _  s_ _ _ _ _ s",
                phonetic: "/Éªn haÉª ËˆspÉªrÉªts/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "experience", 
                definition: "ç»å†ï¼›ç»éªŒvç»å†", 
                hint: "e _ _ _ _ _ _ _ _ e",
                phonetic: "/ÉªkËˆspÉªÉ™riÉ™ns/",
                partOfSpeech: "n."
            },
            { 
                word: "through", 
                definition: "ç©¿è¿‡ï¼›å‡­å€Ÿ", 
                hint: "t _ _ _ _ _ h",
                phonetic: "/Î¸ruË/",
                partOfSpeech: "prep."
            },
            { 
                word: "glad", 
                definition: "é«˜å…´çš„", 
                hint: "g _ _ d",
                phonetic: "/É¡lÃ¦d/",
                partOfSpeech: "adj."
            },
            { 
                word: "peak", 
                definition: "å±±é¡¶", 
                hint: "p _ _ k",
                phonetic: "/piËk/",
                partOfSpeech: "n."
            },
            { 
                word: "grey", 
                definition: "ç°è‰²çš„", 
                hint: "g _ _ y",
                phonetic: "/É¡reÉª/",
                partOfSpeech: "adj."
            },
            { 
                word: "because of", 
                definition: "å› ä¸º", 
                hint: "b _ _ _ _ _ e  o_",
                phonetic: "/bÉªËˆkÉ’z É™v/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "fog", 
                definition: "é›¾", 
                hint: "f _ g",
                phonetic: "/fÉ’É¡/",
                partOfSpeech: "n."
            },
            { 
                word: "ground", 
                definition: "åœ°é¢", 
                hint: "g _ _ _ _ d",
                phonetic: "/É¡raÊŠnd/",
                partOfSpeech: "n."
            },
            { 
                word: "wet", 
                definition: "æ¹¿çš„", 
                hint: "w _ t",
                phonetic: "/wet/",
                partOfSpeech: "adj."
            },
            { 
                word: "tiring", 
                definition: "ä»¤äººç–²æƒ«çš„ç´¯äººçš„", 
                hint: "t _ _ _ _ g",
                phonetic: "/ËˆtaÉªÉ™rÉªÅ‹/",
                partOfSpeech: "adj."
            },
            { 
                word: "seem", 
                definition: "ä¼¼ä¹ï¼›æ˜¾å¾—", 
                hint: "s _ _ m",
                phonetic: "/siËm/",
                partOfSpeech: "v."
            },
            { 
                word: "sunlight", 
                definition: "å…‰ï¼›é˜³å…‰", 
                hint: "s _ _ _ _ _ _ t",
                phonetic: "/ËˆsÊŒnlaÉªt/",
                partOfSpeech: "n."
            },
            { 
                word: "at the top", 
                definition: "åœ¨é¡¶éƒ¨ï¼›åœ¨é¡¶ç«¯", 
                hint: "a_  t_ _  t_ _",
                phonetic: "/Ã¦t Ã°É™ tÉ’p/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "thought", 
                definition: "æƒ³æ³•", 
                hint: "t _ _ _ _ _ t",
                phonetic: "/Î¸É”Ët/",
                partOfSpeech: "n."
            },
            { 
                word: "mountain", 
                definition: "å±±ï¼›é«˜å±±", 
                hint: "m _ _ _ _ _ _ n",
                phonetic: "/ËˆmaÊŠntÉ™n/",
                partOfSpeech: "n."
            },
            { 
                word: "end", 
                definition: "æœ«å°¾ï¼›ç»“æŸ", 
                hint: "e _ d",
                phonetic: "/end/",
                partOfSpeech: "n."
            },
            { 
                word: "at the end", 
                definition: "æœ€åï¼›åœ¨æœ«å°¾", 
                hint: "a_  t_ _  e_ _",
                phonetic: "/Ã¦t Ã°É™ end/",
                partOfSpeech: "çŸ­è¯­"
            },
            { 
                word: "storm", 
                definition: "æš´é£é›¨ï¼›æš´é£é›ª", 
                hint: "s _ _ _ m",
                phonetic: "/stÉ”Ëm/",
                partOfSpeech: "n."
            },
            { 
                word: "pour", 
                definition: "å€¾å€’ï¼›å€’å‡º", 
                hint: "p _ _ r",
                phonetic: "/pÉ”Ë(r)/",
                partOfSpeech: "v."
            },
            { 
                word: "wind", 
                definition: "é£", 
                hint: "w _ _ d",
                phonetic: "/wÉªnd/",
                partOfSpeech: "n."
            },
            { 
                word: "shout", 
                definition: "å–Šå«ï¼›å‘¼å–Š", 
                hint: "s _ _ _ t",
                phonetic: "/ÊƒaÊŠt/",
                partOfSpeech: "v. & n."
            },
            { 
                word: "run after", 
                definition: "è¿½é€", 
                hint: "r_ _  a_ _ _ _",
                phonetic: "/rÊŒn ËˆÉ‘ËftÉ™r/",
                partOfSpeech: "çŸ­è¯­"
            }
        ];

        // éšæœºæ’åºå•è¯åˆ—è¡¨
        const shuffledVocabulary = shuffleArray([...vocabulary]);
        
        // ç”¨æˆ·å­¦ä¹ çŠ¶æ€
        let currentPosition = 0;               // å½“å‰åœ¨å†å²è®°å½•ä¸­çš„ä½ç½®
        let studyHistory = [];                // å­¦ä¹ å†å²è®°å½•
        let wordAnswers = {};                 // å­˜å‚¨ç”¨æˆ·å¯¹æ¯ä¸ªå•è¯çš„å›ç­”
        let score = 0;
        let correctCount = 0;
        let wrongCount = 0;
        
        const definitionElement = document.getElementById("definition");
        const hintElement = document.getElementById("hint");
        const answerInput = document.getElementById("answer");
        const checkButton = document.getElementById("check-btn");
        const nextButton = document.getElementById("next-btn");
        const prevButton = document.getElementById("prev-btn");
        const feedbackElement = document.getElementById("feedback");
        const progressElement = document.getElementById("progress");
        const progressBarElement = document.getElementById("progress-bar");
        const scoreElement = document.getElementById("score");
        const correctCountElement = document.getElementById("correct-count");
        const wrongCountElement = document.getElementById("wrong-count");
        const speakDefinitionButton = document.getElementById("speak-definition");
        const voiceLanguageSelect = document.getElementById("voice-language");
        const voiceRateInput = document.getElementById("voice-rate");

        // è¯­éŸ³åˆæˆ
        const synth = window.speechSynthesis;

        // åˆå§‹åŒ–
        function init() {
            // æ·»åŠ ç¬¬ä¸€ä¸ªå•è¯åˆ°å†å²è®°å½•
            const randomIndex = Math.floor(Math.random() * shuffledVocabulary.length);
            studyHistory.push(randomIndex);
            displayCurrentWord();
        }

        // æ˜¾ç¤ºå½“å‰å•è¯
        function displayCurrentWord() {
            const currentWordIndex = studyHistory[currentPosition];
            const currentWord = shuffledVocabulary[currentWordIndex];
            
            // æ˜¾ç¤ºå®šä¹‰ã€éŸ³æ ‡å’Œè¯æ€§
            definitionElement.innerHTML = `
                ${currentWord.definition}
                <div class="mt-2">
                    <span class="text-indigo-600 font-semibold">${currentWord.partOfSpeech}</span>
                    <span class="text-gray-500 font-mono ml-2">${currentWord.phonetic}</span>
                    <button id="speak-word" class="ml-2 text-indigo-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
                        </svg>
                    </button>
                </div>
            `;
            
            hintElement.textContent = currentWord.hint;
            
            // å¦‚æœè¯¥å•è¯å·²ç»å›ç­”è¿‡ï¼Œæ˜¾ç¤ºä¹‹å‰çš„ç­”æ¡ˆå’Œåé¦ˆ
            if (wordAnswers[currentWordIndex]) {
                const answerData = wordAnswers[currentWordIndex];
                answerInput.value = answerData.answer;
                answerInput.disabled = true;
                checkButton.disabled = true;
                
                // æ˜¾ç¤ºä¹‹å‰çš„åé¦ˆ
                if (answerData.correct) {
                    feedbackElement.innerHTML = `
                        <div class="flex items-center">
                            <span>æ­£ç¡®ï¼ğŸ‘</span>
                            <div class="ml-auto">
                                <span class="text-gray-600 mr-2">${currentWord.word}</span>
                                <span class="text-indigo-600 font-semibold">${currentWord.partOfSpeech}</span>
                                <span class="text-gray-500 font-mono ml-2">${currentWord.phonetic}</span>
                            </div>
                        </div>
                    `;
                    feedbackElement.classList.remove("hidden", "bg-red-100");
                    feedbackElement.classList.add("bg-green-100", "text-green-700");
                } else {
                    feedbackElement.innerHTML = `
                        <div class="flex items-center">
                            <span>é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯:</span>
                            <div class="ml-auto">
                                <span class="font-semibold">${currentWord.word}</span>
                                <span class="text-indigo-600 font-semibold ml-2">${currentWord.partOfSpeech}</span>
                                <span class="text-gray-500 font-mono ml-2">${currentWord.phonetic}</span>
                            </div>
                        </div>
                    `;
                    feedbackElement.classList.remove("hidden", "bg-green-100");
                    feedbackElement.classList.add("bg-red-100", "text-red-700");
                }
            } else {
                // æ–°å•è¯ï¼Œé‡ç½®è¾“å…¥æ¡†
                answerInput.value = "";
                answerInput.disabled = false;
                checkButton.disabled = false;
                feedbackElement.classList.add("hidden");
            }
            
            // æ›´æ–°è¿›åº¦
            progressElement.textContent = `${currentPosition + 1}/${vocabulary.length}`;
            const progressPercentage = ((currentPosition + 1) / vocabulary.length) * 100;
            progressBarElement.style.width = `${progressPercentage}%`;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            prevButton.disabled = currentPosition === 0;
            nextButton.disabled = currentPosition === studyHistory.length - 1 && studyHistory.length === vocabulary.length;
            
            // å¦‚æœåœ¨å†å²è®°å½•çš„æœ€åä½ç½®ï¼Œä½†è¿˜æ²¡å­¦å®Œæ‰€æœ‰å•è¯
            if (currentPosition === studyHistory.length - 1 && studyHistory.length < vocabulary.length) {
                nextButton.textContent = "æ–°å•è¯";
                nextButton.disabled = false;
            } else {
                nextButton.textContent = "ä¸‹ä¸€ä¸ª";
            }
            
            // ä¸ºå•è¯å‘éŸ³æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            document.getElementById("speak-word").addEventListener("click", function() {
                speakText(currentWord.word);
            });
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        checkButton.addEventListener("click", function() {
            const currentWordIndex = studyHistory[currentPosition];
            const currentWord = shuffledVocabulary[currentWordIndex];
            const userAnswer = answerInput.value.trim().toLowerCase();
            const isCorrect = userAnswer === currentWord.word.toLowerCase();
            
            // ä¿å­˜ç”¨æˆ·å›ç­”
            wordAnswers[currentWordIndex] = {
                answer: userAnswer,
                correct: isCorrect
            };
            
            if (isCorrect) {
                feedbackElement.innerHTML = `
                    <div class="flex items-center">
                        <span>æ­£ç¡®ï¼ğŸ‘</span>
                        <div class="ml-auto">
                            <span class="text-gray-600 mr-2">${currentWord.word}</span>
                            <span class="text-indigo-600 font-semibold">${currentWord.partOfSpeech}</span>
                            <span class="text-gray-500 font-mono ml-2">${currentWord.phonetic}</span>
                        </div>
                    </div>
                `;
                feedbackElement.classList.remove("hidden", "bg-red-100");
                feedbackElement.classList.add("bg-green-100", "text-green-700");
                score += 10;
                correctCount++;
            } else {
                feedbackElement.innerHTML = `
                    <div class="flex items-center">
                        <span>é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯:</span>
                        <div class="ml-auto">
                            <span class="font-semibold">${currentWord.word}</span>
                            <span class="text-indigo-600 font-semibold ml-2">${currentWord.partOfSpeech}</span>
                            <span class="text-gray-500 font-mono ml-2">${currentWord.phonetic}</span>
                        </div>
                    </div>
                `;
                feedbackElement.classList.remove("hidden", "bg-green-100");
                feedbackElement.classList.add("bg-red-100", "text-red-700");
                wrongCount++;
            }
            
            // æ›´æ–°ç»Ÿè®¡
            scoreElement.textContent = `å¾—åˆ†: ${score}`;
            correctCountElement.textContent = correctCount;
            wrongCountElement.textContent = wrongCount;
            
            // ç¦ç”¨è¾“å…¥å’Œæ£€æŸ¥æŒ‰é’®
            answerInput.disabled = true;
            checkButton.disabled = true;
            
            // å¯ç”¨ä¸‹ä¸€ä¸ªæŒ‰é’®ï¼ˆå¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå•è¯ï¼‰
            if (studyHistory.length < vocabulary.length || currentPosition < studyHistory.length - 1) {
                nextButton.disabled = false;
            }
            
            // æœ—è¯»æ­£ç¡®ç­”æ¡ˆ
            speakText(currentWord.word);
        });

        // ä¸‹ä¸€ä¸ªå•è¯
        nextButton.addEventListener("click", function() {
            if (currentPosition < studyHistory.length - 1) {
                // å¦‚æœå†å²è®°å½•ä¸­æœ‰ä¸‹ä¸€ä¸ªå•è¯ï¼Œæ˜¾ç¤ºå®ƒ
                currentPosition++;
                displayCurrentWord();
            } else if (studyHistory.length < vocabulary.length) {
                // å¦åˆ™ï¼Œå¦‚æœè¿˜æœ‰æœªå­¦ä¹ çš„å•è¯ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ª
                // è·å–æœªå­¦ä¹ çš„å•è¯ç´¢å¼•
                const learnedIndices = new Set(studyHistory);
                const remainingIndices = [];
                
                for (let i = 0; i < shuffledVocabulary.length; i++) {
                    if (!learnedIndices.has(i)) {
                        remainingIndices.push(i);
                    }
                }
                
                // éšæœºé€‰æ‹©ä¸€ä¸ªæœªå­¦ä¹ çš„å•è¯
                const randomIndex = Math.floor(Math.random() * remainingIndices.length);
                const nextWordIndex = remainingIndices[randomIndex];
                
                // æ·»åŠ åˆ°å†å²è®°å½•
                studyHistory.push(nextWordIndex);
                currentPosition = studyHistory.length - 1;
                
                displayCurrentWord();
            } else {
                // æ‰€æœ‰å•è¯éƒ½å­¦å®Œäº†
                definitionElement.textContent = "æ­å–œï¼ä½ å·²å®Œæˆæ‰€æœ‰å•è¯ã€‚";
                hintElement.textContent = "";
                answerInput.value = "";
                answerInput.disabled = true;
                checkButton.disabled = true;
                nextButton.disabled = true;
                prevButton.disabled = true;
                feedbackElement.classList.remove("hidden", "bg-red-100");
                feedbackElement.classList.add("bg-green-100", "text-green-700");
                feedbackElement.textContent = `æœ€ç»ˆå¾—åˆ†: ${score}/${vocabulary.length * 10}`;
            }
        });

        // ä¸Šä¸€ä¸ªå•è¯
        prevButton.addEventListener("click", function() {
            if (currentPosition > 0) {
                currentPosition--;
                displayCurrentWord();
            }
        });

        // æŒ‰Enteré”®æäº¤ç­”æ¡ˆ
        answerInput.addEventListener("keypress", function(event) {
            if (event.key === "Enter" && !checkButton.disabled) {
                checkButton.click();
            }
        });

        // æœ—è¯»å®šä¹‰
        speakDefinitionButton.addEventListener("click", function() {
            const currentWordIndex = studyHistory[currentPosition];
            const currentWord = shuffledVocabulary[currentWordIndex];
            speakText(currentWord.definition);
        });

        // æœ—è¯»æ–‡æœ¬çš„å‡½æ•°
        function speakText(text) {
            // åœæ­¢ä»»ä½•æ­£åœ¨è¿›è¡Œçš„æœ—è¯»
            synth.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = voiceLanguageSelect.value;
            utterance.rate = parseFloat(voiceRateInput.value);
            
            synth.speak(utterance);
        }

        // æ‰“ä¹±æ•°ç»„çš„è¾…åŠ©å‡½æ•°
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // åˆå§‹åŒ–åº”ç”¨
        init();
    </script>
</body>
</html>
